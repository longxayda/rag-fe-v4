<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£n ƒê·ªì Di S·∫£n B·∫°c Li√™u - C√† Mau</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        #map {
            height: 100vh;
            width: 100%;
        }
        .info-panel {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            max-width: 300px;
            z-index: 1000;
        }
        .info-panel h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .stats {
            font-size: 14px;
            line-height: 1.8;
        }
        .stats strong {
            color: #2c5282;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="info-panel">
        <h3>üó∫Ô∏è Di S·∫£n B·∫°c Li√™u - C√† Mau</h3>
        <div class="stats">
            <div><strong>T·ªïng s·ªë:</strong> <span id="total">0</span> di s·∫£n</div>
            <div><strong>B·∫°c Li√™u:</strong> <span id="bacLieu">0</span></div>
            <div><strong>C√† Mau:</strong> <span id="caMau">0</span></div>
            <div><strong>Kh√°c:</strong> <span id="other">0</span></div>
        </div>
    </div>

    <script>
        // Kh·ªüi t·∫°o b·∫£n ƒë·ªì trung t√¢m t·∫°i B·∫°c Li√™u - C√† Mau
        const map = L.map('map').setView([9.2353, 105.4411], 9);

        // Th√™m tile layer t·ª´ OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 18
        }).addTo(map);

        // Load d·ªØ li·ªáu t·ª´ heritages.json
        fetch('./src/data/heritages.json')
            .then(response => response.json())
            .then(heritages => {
                let bacLieuCount = 0;
                let caMauCount = 0;
                let otherCount = 0;

                // T·∫°o marker cho m·ªói di s·∫£n
                heritages.forEach(heritage => {
                    const { lat, lng, name, address, commune, rankingType } = heritage;
                    
                    // ƒê·∫øm theo t·ªânh
                    if (address.includes('B·∫°c Li√™u') || commune.includes('B·∫°c Li√™u')) {
                        bacLieuCount++;
                    } else if (address.includes('C√† Mau') || commune.includes('C√† Mau')) {
                        caMauCount++;
                    } else {
                        otherCount++;
                    }

                    // Ch·ªçn m√†u marker theo lo·∫°i x·∫øp h·∫°ng
                    let markerColor = 'blue';
                    if (rankingType && rankingType.includes('Qu·ªëc gia ƒë·∫∑c bi·ªát')) {
                        markerColor = 'red';
                    } else if (rankingType && rankingType.includes('Qu·ªëc gia')) {
                        markerColor = 'orange';
                    } else if (rankingType && rankingType.includes('t·ªânh')) {
                        markerColor = 'green';
                    }

                    // T·∫°o marker v·ªõi custom icon
                    const marker = L.marker([lat, lng], {
                        icon: L.divIcon({
                            className: 'custom-marker',
                            html: `<div style="background-color: ${markerColor}; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 4px rgba(0,0,0,0.5);"></div>`,
                            iconSize: [12, 12],
                            iconAnchor: [6, 6]
                        })
                    }).addTo(map);

                    // Th√™m popup
                    marker.bindPopup(`
                        <div style="max-width: 250px;">
                            <h4 style="margin: 0 0 8px 0; color: #2c5282;">${name}</h4>
                            <p style="margin: 4px 0; font-size: 13px;"><strong>ƒê·ªãa ch·ªâ:</strong> ${address || 'N/A'}</p>
                            <p style="margin: 4px 0; font-size: 13px;"><strong>X√£/Ph∆∞·ªùng:</strong> ${commune || 'N/A'}</p>
                            <p style="margin: 4px 0; font-size: 13px;"><strong>X·∫øp h·∫°ng:</strong> ${rankingType || 'N/A'}</p>
                            <p style="margin: 4px 0; font-size: 12px; color: #666;"><strong>T·ªça ƒë·ªô:</strong> ${lat.toFixed(4)}, ${lng.toFixed(4)}</p>
                        </div>
                    `);
                });

                // C·∫≠p nh·∫≠t th·ªëng k√™
                document.getElementById('total').textContent = heritages.length;
                document.getElementById('bacLieu').textContent = bacLieuCount;
                document.getElementById('caMau').textContent = caMauCount;
                document.getElementById('other').textContent = otherCount;

                console.log('‚úÖ ƒê√£ load th√†nh c√¥ng', heritages.length, 'di s·∫£n');
            })
            .catch(error => {
                console.error('‚ùå L·ªói khi load d·ªØ li·ªáu:', error);
                alert('Kh√¥ng th·ªÉ load d·ªØ li·ªáu di s·∫£n. Vui l√≤ng ki·ªÉm tra ƒë∆∞·ªùng d·∫´n file.');
            });
    </script>
</body>
</html>

